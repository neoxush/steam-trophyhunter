<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Steam Trophy Hunter</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body data-theme="light">
    <!-- Fixed Navigation -->
    <nav class="fixed-nav">
        <div class="nav-header">
            <h1>Steam Trophy Hunter</h1>
            <div class="nav-buttons">
                <button class="btn-nav" onclick="showAddGameModal()" title="Add Game">‚ûï</button>
                <button class="btn-nav" onclick="showDataModal()" title="Import / Export Data">üíæ</button>
                <button class="btn-nav" onclick="showSettingsModal()" title="Settings">‚öôÔ∏è</button>
                <button class="btn-nav" onclick="toggleTheme()" title="Theme">üåì</button>
            </div>
        </div>

        <div class="game-tabs" id="gameTabs"></div>

        <div class="nav-controls">
            <button id="deleteGameBtn" class="btn-nav hidden" onclick="confirmDeleteGame()"
                title="Delete Current Game">üóëÔ∏è</button>
            <button id="syncProgressBtn" class="btn-nav hidden" onclick="showSyncModal()"
                title="Pasteboard Sync (Mark Done Achievements)">üìã</button>
            <input type="text" id="searchInput" placeholder="Search a trophy or paste with your Steam trophy list">
            <select id="filterSelect">
                <option value="all">All</option>
                <option value="incomplete">Incomplete</option>
                <option value="completed">Completed</option>
            </select>
            <span class="stats-compact"><span id="completedCount">0</span>/<span id="totalCount">0</span></span>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <div id="emptyState" class="empty-state">
            <p>No achievements found</p>
            <div class="empty-state-actions">
                <button class="btn-primary" onclick="showAddGameModal()">+ Add Game</button>
                <button class="btn-secondary" onclick="showDataModal()">Import Data</button>
            </div>
        </div>
        <div id="achievementList" class="achievement-list hidden"></div>
    </main>

    <!-- Add Game Modal -->
    <div id="addGameModal" class="modal hidden">
        <div class="modal-overlay" onclick="closeAddGameModal()"></div>
        <div class="modal-content">
            <h3>Add Game</h3>
            <input type="text" id="appIdInput" placeholder="App ID (e.g., 2499860)">
            <input type="text" id="gameNameInput" placeholder="Game Name">
            <div id="addGameError" class="error-msg hidden"></div>
            <div id="addGameLoading" class="loading-msg hidden">Fetching...</div>
            <div class="modal-buttons">
                <button class="btn-secondary" onclick="closeAddGameModal()">Cancel</button>
                <button class="btn-primary" id="addGameBtn" onclick="addGameByAppId()">Add</button>
            </div>
        </div>
    </div>

    <!-- Data Management Modal -->
    <div id="dataModal" class="modal hidden">
        <div class="modal-overlay" onclick="closeDataModal()"></div>
        <div class="modal-content">
            <h3>Data Management</h3>
            <p class="modal-subtitle">Export your progress to transfer to another device or backup.</p>

            <div class="data-section">
                <h4>Export Data</h4>
                <div class="field-group">
                    <textarea id="exportInput" readonly placeholder="Your data will appear here..."></textarea>
                    <button class="btn-primary" onclick="exportData()">Copy to Clipboard</button>
                </div>
            </div>

            <div class="data-section">
                <h4>Import Data</h4>
                <div class="field-group">
                    <textarea id="importInput" placeholder="Paste your data code here..."></textarea>
                    <button class="btn-warning" onclick="importData()">Import & Overwrite</button>
                    <div id="importError" class="error-msg hidden"></div>
                </div>
            </div>

            <div class="data-section">
                <h4>Reset</h4>
                <div class="field-group">
                    <button class="btn-danger" onclick="clearData()">Reset All Data</button>
                </div>
            </div>

            <div class="modal-buttons">
                <button class="btn-secondary" onclick="closeDataModal()">Close</button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal hidden">
        <div class="modal-overlay" onclick="closeSettingsModal()"></div>
        <div class="modal-content">
            <h3>Settings</h3>

            <div class="settings-section">
                <h4>AI Assistant</h4>
                <p>Customize which AI service to use for achievement guides.</p>
                <div class="setting-item">
                    <label for="aiProviderSelect">AI Provider:</label>
                    <select id="aiProviderSelect" class="settings-select" onchange="saveSettings()">
                        <option value="gemini">Google Gemini (Default)</option>
                        <option value="chatgpt">ChatGPT</option>
                        <option value="claude">Claude</option>
                        <option value="perplexity">Perplexity</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="aiLanguageSelect">Guide Language:</label>
                    <select id="aiLanguageSelect" class="settings-select" onchange="saveSettings()">
                        <option value="Chinese">Chinese (Default)</option>
                        <option value="English">English</option>
                        <option value="Japanese">Japanese</option>
                        <option value="Korean">Korean</option>
                        <option value="Spanish">Spanish</option>
                        <option value="French">French</option>
                        <option value="German">German</option>
                    </select>
                </div>
            </div>

            <div class="settings-section">
                <h4>About</h4>
                <p>Steam Trophy Hunter v1.1</p>
                <p>Track achievements across multiple games</p>
            </div>

            <button class="btn-primary" onclick="closeSettingsModal()">Close</button>
        </div>
    </div>

    <!-- Sync Progress Modal -->
    <div id="syncModal" class="modal hidden">
        <div class="modal-overlay" onclick="closeSyncModal()"></div>
        <div class="modal-content">
            <h3>Sync Progress</h3>
            <p class="modal-subtitle">Sync your achievements by pasting text from your Steam Community profile.</p>

            <div class="field-group">
                <textarea id="syncInput" placeholder="Paste all achievement text here..."></textarea>
                <div class="info-box">
                    <p><strong>How to sync:</strong> Go to your Steam Achievements page, press <code>Ctrl + A</code>
                        (Select All), <code>Ctrl + C</code> (Copy), and then paste it here. We'll automatically find the
                        ones you've finished.</p>
                </div>
            </div>

            <div class="modal-buttons">
                <button class="btn-secondary" onclick="closeSyncModal()">Cancel</button>
                <button class="btn-primary" onclick="processBulkSync()">Sync Progress</button>
                <button class="btn-warning" onclick="processBulkSync(true)">Sync & Overwrite</button>
            </div>
        </div>
    </div>

    <!-- Guide Prompt Modal -->
    <div id="guideModal" class="modal hidden">
        <div class="modal-overlay" onclick="closeGuideModal()"></div>
        <div class="modal-content">
            <h3>Ask AI for Help üß†</h3>
            <p>Tip: You can edit this text. It will be copied to your clipboard automatically
                when you proceed.</p>

            <div class="field-group">
                <textarea id="guidePromptInput" class="modal-textarea" title="Customize your AI Prompt"></textarea>
                <div class="checkbox-wrapper">
                    <input type="checkbox" id="includeAllIncomplete">
                    <label for="includeAllIncomplete">Include all incomplete achievements for this game</label>
                </div>
            </div>

            <div class="modal-buttons">
                <button class="btn-secondary" onclick="closeGuideModal()">Cancel</button>
                <button class="btn-primary" onclick="confirmGuideLaunch()">Okay, take me there üöÄ</button>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>

</html>